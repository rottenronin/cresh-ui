import{d as M,j as V,k as c,l as P,m as z,n as U,o as _,c as p,q as E,w as m,b as o,e as f,t as k,s as b,v as C,u as v,_ as H,L as K,x as Q,C as G,a as I}from"./index-e7347527.js";import{_ as J}from"./CCard.vue_vue_type_script_setup_true_lang-0952f46a.js";import{_ as W}from"./CDropdown.vue_vue_type_script_setup_true_lang-d4769476.js";function q(l){return l&&Object.prototype.toString.call(l)==="[object Date]"&&!Number.isNaN(l)}function X(l,r="fr-FR",s={day:"numeric",month:"numeric",year:"numeric"}){return q(l)?l.toLocaleDateString(r,s):""}function Z(l){const r=l.getDate(),s=l.getFullYear(),t=l.getMonth();return new Date(s,t,r,0,0,0,0)}function j(l){const r=l.getDate(),s=l.getFullYear(),t=l.getMonth();return new Date(s,t,r,23,59,59,999)}const y={toLocaleDateString:X,isValidDate:q,beginningOfTheDay:Z,endOfTheDay:j},ee={class:"c-date-range-filters"},te={class:"left-content"},ae={key:0},ne={key:0,class:"right-content"},D=M({__name:"CDateRangeFilters",props:{dateFilter:{type:String,required:!1,default:"today"},dateRange:{type:Array,required:!1,default:()=>[]},activator:{type:String,required:!1,default:"date-filter"}},emits:["filters-select"],setup(l,{emit:r}){const s=l,t=V({activator:"date-filter",dateFiltersDropdownVisible:!1,dateRangePickerVisible:!1,dateRange:[],dateFilter:"today",initialized:!1}),d=[{key:c.global.t("translate.filters.dates.today"),value:"today"},{key:c.global.t("translate.filters.dates.last_7_days"),value:"fweek"},{key:c.global.t("translate.filters.dates.last_4_weeks"),value:"fmonth"},{key:c.global.t("translate.filters.dates.last_3_months"),value:"fquarter"},{key:c.global.t("translate.filters.dates.last_12_months"),value:"fyear"},{key:c.global.t("translate.filters.dates.month_to_date"),value:"month"},{key:c.global.t("translate.filters.dates.quarter_to_date"),value:"quarter"},{key:c.global.t("translate.filters.dates.year_to_date"),value:"year"},{key:c.global.t("translate.filters.dates.all_time"),value:"all"}],w=P(),x=z(()=>!!w.rightContent);function N(a){const e=new Date,n=new Date;t.dateFilter=a,t.activator="date-filter";function u(i,g){t.dateRange=[`${i.getFullYear()}-${i.getMonth()+1}-${i.getDate()}`,`${g.getFullYear()}-${g.getMonth()+1}-${g.getDate()}`]}switch(a){case"today":u(e,e);break;case"fweek":n.setDate(e.getDate()-7),u(n,e);break;case"fmonth":n.setDate(e.getDate()-28),u(n,e);break;case"fquarter":n.setMonth(e.getMonth()-3),u(n,e);break;case"fyear":n.setMonth(e.getMonth()-12),u(n,e);break;case"month":{const i=new Date(e.getFullYear(),e.getMonth(),1);u(i,e);break}case"quarter":{const i=[0,1,2],g=[3,4,5],S=[6,7,8],$=[9,10,11],F=e.getMonth();let[h]=i;g.includes(F)?[h]=g:S.includes(F)?[h]=S:$.includes(F)&&([h]=$);const B=new Date(e.getFullYear(),h,1);u(B,e);break}case"year":{const i=new Date(e.getFullYear(),0,1);u(i,e);break}}}function Y(){t.activator="date-range"}function L(){t.dateRange=[]}function O([a,e]){return!a||!e?"":`${y.toLocaleDateString(a)} - ${y.toLocaleDateString(e)}`}function T(a){const e=d.findIndex(n=>n.value===a);if(e>-1)return d[e]}function R({value:a}){N(a),t.dateFilter=a,L(),r("filters-select",{dateFilter:a,dateRange:void 0,activator:t.activator})}function A(a){if(t.activator=a===null?"date-filter":"date-range",!a||!Array.isArray(a)||a.length!==2)return;const e=y.beginningOfTheDay(a[0]),n=y.endOfTheDay(a[1]);t.dateRange=[e,n],r("filters-select",{dateFilter:void 0,dateRange:t.dateRange,activator:t.activator})}return U(()=>{t.activator=s.activator,t.dateFilter=s.dateFilter,t.dateRange=s.dateRange,t.initialized=!0}),(a,e)=>(_(),p("div",ee,[t.initialized?(_(),E(v(J),{key:0,class:"c-date-range-filters"},{default:m(()=>[o("div",te,[f(v(W),{modelValue:t.dateFiltersDropdownVisible,"onUpdate:modelValue":e[0]||(e[0]=n=>t.dateFiltersDropdownVisible=n),items:d,onSelect:R,class:C(["date-filter",{active:t.activator==="date-filter"}]),"pre-selected-item":t.dateFilter?T(t.dateFilter):void 0},{default:m(({selectedItem:n})=>[n?(_(),p("div",ae,k(n.key),1)):b("",!0)]),_:1},8,["modelValue","class","pre-selected-item"]),f(v(K),{"model-value":t.dateRange,"onUpdate:modelValue":A,"hide-input-icon":"",range:"","multi-calendars":"","hide-offset-dates":"","multi-static":!1,"enable-time-picker":!1,locale:"fr",format:O||"",onOpen:Y,onCleared:e[1]||(e[1]=n=>R({value:"today",key:a.$t("translate.filters.dates.today")})),"max-date":new Date,"auto-apply":"",class:C({"date-range-filter":!0,active:t.activator==="date-range"})},{"clear-icon":m(({clear:n})=>[f(v(H),{class:"input-slot-image",name:"cross-circle",color:"#FC5A5A",onClick:n},null,8,["onClick"])]),_:1},8,["model-value","format","max-date","class"])]),x.value?(_(),p("div",ne,[Q(a.$slots,"rightContent")])):b("",!0)]),_:3})):b("",!0)]))}}),le={class:"date-range-filters-page"},re=o("div",null,"default use",-1),se=o("div",null," with custom right content template ",-1),oe=o("div",null," with initial values ",-1),ie=o("div",null," pre-selected date ranges ",-1),ce=o("br",null,null,-1),de=o("br",null,null,-1),ue=o("div",null," pre-select date filter to 'fyear' ",-1),ve=M({__name:"DateRangeFiltersPage",setup(l){const r=V({data2:{activator:"date-range",dateFilter:"fmonth",dateRange:[new Date(1999,1,1),new Date(2019,1,1)]}});function s(d){r.data=d}function t(d){r.data2=d}return(d,w)=>(_(),p("div",le,[re,f(D,{onFiltersSelect:s}),o("div",null," selected data: "+k(r.data),1),se,f(D,{onFiltersSelect:s},{rightContent:m(()=>[f(v(G),null,{default:m(()=>[I(" Confirmer ")]),_:1})]),_:1}),o("div",null," selected data: "+k(r.data),1),oe,ie,f(D,{onFiltersSelect:t,"date-range":r.data2.dateRange,activator:r.data2.activator},null,8,["date-range","activator"]),o("div",null," selected data: "+k(r.data2),1),ce,de,ue,f(D,{onFiltersSelect:t,"date-filter":"fyear",activator:"date-filter"})]))}});export{ve as default};

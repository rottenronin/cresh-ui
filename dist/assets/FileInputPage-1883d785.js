import{d as _,A as B,j as k,m as g,n as $,o as t,c as p,b as i,e as m,w as d,_ as q,q as b,u as v,s as y,P,v as C,k as h,O as c,F as U,B as E,t as T}from"./index-e7347527.js";import{C as j}from"./CInput-d2664611.js";import{p as A}from"./base-control-props-3c9ee147.js";import{_ as N,f as H}from"./CErrorMessage.vue_vue_type_script_setup_true_lang-7df33b07.js";const J={class:"c-file-input"},M={class:"file-trigger"},O=["accept"],R=_({__name:"CFileInput",props:{...A,validFileExtensions:{type:Array,required:!1,default:()=>["application/pdf","image/jpeg","image/png","image/jpg"]},hideProgression:{type:Boolean,default:!1,required:!1},maxSize:{type:Number,required:!1,default:2*1024},animationHook:{type:Function,default:null,required:!1},modelValue:{type:Object,required:!1,default:()=>{}},filename:{type:String,required:!1,default:""}},emits:["update:model-value"],setup(s,{emit:o}){const a=s,l=B(null),e=k({filename:"",isUploading:!1,progressValue:0,progressSpeed:.5}),u=g(()=>a.validFileExtensions.join(","));function f(){l.value&&l.value.click()}function F(r){return r.size>a.maxSize*1024}function V(r){return a.validFileExtensions.includes(r.type)}async function w(r){if(!V(r))throw Error(h.global.t("translate.common.errors.file_size_error",{name:r.name,size:a.maxSize}));if(F(r))throw Error(h.global.t("translate.common.errors.file_size_error_alt",{size:a.maxSize}))}function I(){if(e.error){e.isUploading=!1;return}if(e.progressValue>=99?(e.progressValue=100,window.clearInterval(e.animationId),window.setTimeout(()=>{e.isUploading=!1,e.progressSpeed=.5},22)):(e.progressValue+=e.progressSpeed,e.progressSpeed+=1),a.animationHook){const r=a.animationHook(e.progressValue);e.progressValue=r}}function S(){e.isUploading=!0,e.progressValue=0,e.error=void 0,e.animationId=window.setInterval(I,22)}async function x(r){try{e.isUploading=!0,S(),e.error=void 0,e.file=void 0;const n=H.convertJpegToJpg(r);await w(n),e.file=n,e.filename=n.name,o("update:model-value",n)}catch(n){e.error={message:n.message},e.isUploading=!1}}async function z(r){const n=r.target;n.files&&n.files.length>0&&await x(n.files[0])}return $(()=>{var r;a.modelValue&&(e.file=a.modelValue,e.filename=(r=a.modelValue)==null?void 0:r.name),a.filename&&(e.filename=a.filename)}),(r,n)=>(t(),p("div",J,[i("div",M,[m(j,{name:`${r.name}Input`,"model-value":e.filename,placeholder:r.placeholder,label:r.label,bordered:r.bordered,onClick:P(f,["prevent","stop"]),class:C(e.error?"invalid":"")},{prefix:d(()=>[m(q,{name:"attachment"})]),progressbar:d(()=>[e.isUploading&&!s.hideProgression?(t(),b(v(D),{key:0,value:e.progressValue,color:"primary"},null,8,["value"])):y("",!0)]),error:d(()=>[e.error?(t(),b(v(N),{key:0,error:e.error},null,8,["error"])):y("",!0)]),_:1},8,["name","model-value","placeholder","label","bordered","onClick","class"])]),i("input",{name:"fileUploadInput",type:"file",accept:u.value,onChange:z,ref_key:"inputRef",ref:l,style:{display:"none"}},null,40,O)]))}}),D=_({__name:"CProgressBar",props:{value:{type:Number,required:!1,default:0},color:{type:String,required:!1,default:"primary"},indeterminate:{type:Boolean,required:!1,default:!1}},setup(s){const o=s,a=g(()=>["primary","secondary","tertiary","warning","info","success","error"].includes(o.color)),l=g(()=>a.value?`var(--color-${o.color})`:o.color);return(e,u)=>(t(),p("div",{class:C(["c-progress-bar",`c-progress-bar ${s.indeterminate?"indeterminate":""}`])},[i("div",{class:"c-progress-bar-background",style:c({"background-color":l.value})},null,4),i("div",{class:"progression",style:c({width:`${s.value}%`,"background-color":l.value})},null,4),s.indeterminate?(t(),p(U,{key:0},[i("div",{class:"subline inc",style:c({"background-color":l.value})},null,4),i("div",{class:"subline dec",style:c({"background-color":l.value})},null,4)],64)):y("",!0)],2))}}),G={class:"examples"},K=i("h2",null,"Basic",-1),L=i("br",null,null,-1),Z=_({__name:"FileInputPage",setup(s){const o=k({});return(a,l)=>{const e=E("CCodeSnippet");return t(),p("div",G,[K,m(e,{snippet:`
        <CFileInput
          name='cFileInput'
          label='file input ex1'
        />
      `},{default:d(()=>{var u;return[m(v(R),{name:"cFileInput",label:"file input ex1",modelValue:o.selectedFile,"onUpdate:modelValue":l[0]||(l[0]=f=>o.selectedFile=f)},null,8,["modelValue"]),L,i("div",null," selected file: "+T((u=o.selectedFile)==null?void 0:u.name),1)]}),_:1})])}}});export{Z as default};

import{d as $,o as r,c,b as s,F as S,I as R,v as L,P as N,t as C,q as w,s as h,l as z,m as f,x as q,e as k,u as P,k as I,w as O,C as T,a as J,j as K,R as G,J as B,i as Q,B as D}from"./index-50829d1b.js";import{_ as W}from"./ArrowDownIcon.vue_vue_type_script_setup_true_lang-98538112.js";import{_ as X}from"./ArrowUpIcon.vue_vue_type_script_setup_true_lang-4dc40c1f.js";import{_ as Y}from"./RefreshIcon.vue_vue_type_script_setup_true_lang-98aa521d.js";import{_ as Z}from"./TableIcon.vue_vue_type_script_setup_true_lang-798c56a2.js";import{_ as ee}from"./CSelect.vue_vue_type_script_setup_true_lang-d135e13c.js";import{_ as te}from"./ChevronLeftIcon.vue_vue_type_script_setup_true_lang-d652f20d.js";import{_ as ae}from"./ChevronRightIcon.vue_vue_type_script_setup_true_lang-7dc4423c.js";const ne={class:"c-datatable-header"},se=["onClick"],oe=$({__name:"CDatatableHeader",props:{headers:{type:Array,required:!0,default:()=>[]},sortBy:{type:Array,required:!0,default:()=>[]}},emits:["update:sort-by"],setup(e,{emit:o}){const n=e,g=d=>n.sortBy.findIndex(l=>l.key===d.key)>-1,p=d=>n.sortBy.find(a=>a.key===d.key).sortOrder==="asc",m=d=>n.sortBy.find(a=>a.key===d.key).sortOrder==="desc";function t(d){if(d.sortable){const l=d.sortOrder==="asc"?"desc":d.sortOrder==="desc"?null:"asc";o("update:sort-by",d,l)}}return(d,l)=>(r(),c("thead",ne,[s("tr",null,[(r(!0),c(S,null,R(e.headers,a=>(r(),c("th",{key:a.key,class:L(`header-item align-${a.align}
          ${a.sortable?"sortable":""}`),onClick:N(()=>t(a),["prevent","stop"])},[s("span",null,C(a.text),1),a.sortable?(r(),c(S,{key:0},[g(a)?(r(),c("span",{key:0,class:L(`sort-by-${a.key} c-ml-5`)},[p(a)?(r(),w(X,{key:0,color:"primary",width:14,height:14})):h("",!0),m(a)?(r(),w(W,{key:1,color:"primary",width:14,height:14})):h("",!0)],2)):h("",!0)],64)):h("",!0)],10,se))),128))])]))}}),re={key:0,class:"loading-bar-thead"},ie=s("tr",null,[s("th",{class:"loading-bar-wrapper"},[s("div",{class:"slider"},[s("div",{class:"line"}),s("div",{class:"subline inc"}),s("div",{class:"subline dec"})])])],-1),le=[ie],ce=$({__name:"CDatatableLoadingBar",props:{isLoading:{type:Boolean,required:!1,default:!1}},setup(e){return(o,n)=>e.isLoading?(r(),c("thead",re,le)):h("",!0)}});function ue(e,o,n){return n==="asc"?e-o:o-e}function de(e,o,n){return n==="asc"?e.getDate()-o.getDate():o.getDate()-e.getDate()}function F(e,o,n){return n==="asc"?e.toLowerCase().localeCompare(o.toLowerCase()):o.toLowerCase().localeCompare(e.toLowerCase())}function H({items:e,sortBy:o,headers:n}){if(!o||o.length===0)return e;const[g]=o;return[...e].sort((m,t)=>{const d=n.findIndex(b=>b.key===g.key),{customSort:l}=n[d];if(l)return l(m,t,g.sortOrder);const a=m[g.key],u=t[g.key];return typeof a=="number"&&typeof u=="number"?ue(a,u,g.sortOrder):a instanceof Date&&u instanceof Date?de(a,u,g.sortOrder):typeof a=="string"&&typeof u=="string"?F(a,u,g.sortOrder):F(a.toString(),u.toString(),g.sortOrder)})}const ge={key:1,class:"empty-datatable"},me={class:"icon-wrapper"},pe={key:0,class:"empty-text"},fe={key:1,class:"empty-text error"},ye={key:2,class:"retry-btn-wrapper c-mt-15"},be=$({__name:"CDatatableEmptyData",props:{visible:{type:Boolean,required:!1,default:!1},showRetry:{type:Boolean,required:!1,default:!0},hasError:{type:Boolean,required:!1,default:!1}},emits:["retry"],setup(e,{emit:o}){const n=z(),g=f(()=>!!n["empty-bloc"]);function p(){o("retry")}return(m,t)=>(r(),c("tbody",null,[g.value?q(m.$slots,"empty-bloc",{key:0}):(r(),c("tr",ge,[s("td",null,[s("span",me,[k(P(Z),{name:"table",width:32,height:32,color:"tertiary"})]),e.hasError?(r(),c("span",fe,C(P(I).global.t("translate.datatable.error_message")),1)):(r(),c("span",pe,C(P(I).global.t("translate.datatable.no_data")),1)),e.showRetry?(r(),c("span",ye,[k(T,{color:"primary",onClick:N(p,["prevent","stop"])},{default:O(()=>[s("span",null,C(P(I).global.t("translate.datatable.retry")),1),k(P(Y),{name:"refresh",color:"white",width:20,class:"c-ml-5"})]),_:1},8,["onClick"])])):h("",!0)])]))]))}}),ke={class:"c-datatable-footer"},Pe={class:"page-select"},he={class:"page-index"},Ce={class:"current-page-first-index"},_e=s("span",null,"/",-1),ve={class:"current-page-last-index"},we={class:"page-prev-next-triggers"},Se={class:"page-prev-trigger"},$e={class:"page-next-trigger"},Be=$({__name:"CDatatableFooter",props:{pagination:{type:Object,required:!0},itemsPerPage:{type:Number,required:!1,default:10},allowTotal:{type:Boolean,required:!1,default:!1},pages:{type:Array,required:!0}},emits:["update:items-per-page","click:prev-page","click:next-page"],setup(e,{emit:o}){const n=e,g=f(()=>{const a=n.pages.map(u=>({key:u.toString(),value:u.toString(),isDefault:u===n.itemsPerPage,name:u.toString()}));return n.itemsPerPage!==-1&&(a.findIndex(b=>b.value===String(n.itemsPerPage))>-1||a.push({key:String(n.itemsPerPage),value:String(n.itemsPerPage),isDefault:!0,name:n.itemsPerPage.toString()})),n.allowTotal&&a.push({key:"all",value:"-1",isDefault:!1,name:I.global.t("translate.common.all")}),a});function p(a){o("update:items-per-page",Number(a))}const m=f(()=>n.pagination?Number(n.pagination.page):-1),t=f(()=>{if(!n.pagination.itemsPerPage||n.pagination.itemsPerPage===-1)return 1;const a=Number(n.pagination.itemsPerPage),u=Number(n.pagination.totalCount);return Math.ceil(u/a)});function d(){if(m.value<=1)return;const a=Number(n.pagination.page)-1;o("click:prev-page",a)}function l(){if(m.value>=t.value)return;const a=Number(n.pagination.page)+1;o("click:next-page",a)}return(a,u)=>(r(),c("div",ke,[s("div",Pe,[s("label",null,C(P(I).global.t("translate.datatable.footer.rows_per_page")),1),k(ee,{class:"c-datatable-footer-page-select","hide-label":"",name:"datatablePageSelect","model-value":String(e.pagination.itemsPerPage),label:"",options:g.value,"onUpdate:modelValue":p},null,8,["model-value","options"]),s("div",he,[s("span",Ce,C(m.value),1),_e,s("span",ve,C(t.value),1)]),s("div",we,[s("div",Se,[k(T,{text:"",disabled:m.value<=1,onClick:N(d,["prevent","stop"])},{default:O(()=>[k(P(te),{name:"chevron-left"})]),_:1},8,["disabled","onClick"])]),s("div",$e,[k(T,{text:"",disabled:m.value>=t.value,onClick:N(l,["prevent","stop"])},{default:O(()=>[k(P(ae),{name:"chevron-right"})]),_:1},8,["disabled","onClick"])])])])]))}}),De=["onClick"],Ie=$({__name:"CDatatableRowItem",props:{item:{type:Object,required:!0},index:{type:Number,required:!0},clickable:{type:Boolean,required:!1,default:!1},headers:{type:Array,required:!0}},emits:["row:click"],setup(e,{emit:o}){const n=e,g=z();function p(){o("row:click",{item:n.item,index:n.index})}function m(t){return!!g[`item-${t}`]}return(t,d)=>(r(),c("tr",{class:L(`datatable-item ${e.clickable?"cursor-pointer":""}`),onClick:N(p,["prevent","stop"])},[(r(!0),c(S,null,R(e.headers,(l,a)=>(r(),c("td",{key:`item-i${a}-prop-${l.key}`,class:L(`item item-${l.key}`)},[m(l.key)?q(t.$slots,`item-${l.key}`,{key:0,item:e.item,index:e.index,rowIndex:a,columnKey:l.key}):(r(),c(S,{key:1},[J(C(e.item[l.key]),1)],64))],2))),128))],10,De))}}),Ne=s("tr",{class:"skeleton-datatable-row"},[s("td",null,[s("span",{class:"skeleton-loader"})])],-1),qe=s("tr",{class:"skeleton-datatable-row"},[s("td",null,[s("span",{class:"skeleton-loader"})])],-1),Le={class:"skeleton-datatable-row"},Re=s("span",{class:"skeleton-loader"},null,-1),xe={class:"loading-text"},Oe=s("tr",{class:"skeleton-datatable-row"},[s("td",null,[s("span",{class:"skeleton-loader"})])],-1),Te=s("tr",{class:"skeleton-datatable-row"},[s("td",null,[s("span",{class:"skeleton-loader"})])],-1),ze=$({__name:"CDatatableSkeletonRow",props:{showLoading:{type:Boolean,required:!1,default:!1}},setup(e){return(o,n)=>(r(),c("tbody",null,[Ne,qe,s("tr",Le,[s("td",null,[Re,s("span",xe,C(P(I).global.t("translate.datatable.loading")),1)])]),Oe,Te]))}}),Fe=$({name:"CDatatable",components:{CDatatableLoadingBar:ce,CDatatableHeader:oe,CDatatableRowItem:Ie,CDatatableSkeletonRow:ze,CDatatableEmptyData:be,CDatatableFooter:Be},props:{headers:{type:Array,required:!0},rowClickable:{type:Boolean,required:!1,default:!1},items:{type:Array,required:!0},isServerSync:{type:Boolean,required:!1,default:!1},page:{type:Number,required:!1,default:1},pages:{type:Array,required:!1,default:()=>[5,10,15]},itemsPerPage:{type:Number,required:!1,default:10},totalItemsCount:{type:Number,required:!1,default:10},isLoading:{type:Boolean,required:!1,default:!1},multisort:{type:Boolean,required:!1,default:!1},noSkeleton:{type:Boolean,required:!1,default:!1},allowTotal:{type:Boolean,required:!1,default:!1},noFooter:{type:Boolean,required:!1,default:!1}},emits:["update:items-per-page","update:sort-by","update:page-index","row-click","update:retry"],setup(e,{emit:o}){const n=z(),g=f(()=>!!n.header),p=f(()=>!!n.default),m=f(()=>!!n.footer),t=K({items:[],pagination:{page:1,pagesCount:1,itemsPerPage:10,totalCount:0},sortBy:[],showLoading:!0,initialized:!1});G(()=>{t.sortBy=e.headers.filter(i=>i.sortOrder==="asc"||i.sortOrder==="desc"),e.isServerSync?t.pagination={page:e.page,pagesCount:Math.ceil(e.totalItemsCount/e.itemsPerPage),itemsPerPage:e.itemsPerPage,totalCount:e.totalItemsCount,links:void 0}:t.pagination={...t.pagination,page:e.page,itemsPerPage:e.itemsPerPage},t.initialized=!0});const d=f(()=>{if(e.isServerSync||t.pagination.itemsPerPage===-1)return t.items;const i=Number(t.pagination.itemsPerPage),y=i*(Number(t.pagination.page)-1);return t.items.slice(y,y+i)}),l=f(()=>t.pagination?Number(t.pagination.page):-1),a=f(()=>Number(t.pagination.itemsPerPage)*(Number(t.pagination.page)-1)),u=f(()=>{if(!t.pagination.itemsPerPage||t.pagination.itemsPerPage===-1)return 1;const i=Number(t.pagination.itemsPerPage),y=Number(t.pagination.totalCount);return Math.ceil(y/i)});function b(){if(e.isServerSync){t.pagination={page:e.page,pagesCount:Math.ceil(e.totalItemsCount/e.itemsPerPage),itemsPerPage:e.itemsPerPage,totalCount:e.totalItemsCount,links:void 0};return}t.pagination?t.pagination={...t.pagination,pagesCount:Math.ceil(t.items.length/Number(t.pagination.itemsPerPage)),totalCount:t.items.length}:t.pagination={page:1,pagesCount:Math.ceil(t.items.length/e.itemsPerPage),itemsPerPage:e.itemsPerPage,totalCount:t.items.length,links:void 0}}function _(){e.isServerSync?(t.items=e.items,b()):(t.items=H({items:e.items,sortBy:t.sortBy,headers:e.headers}),b())}B(()=>e.items,()=>{t.initialized&&_()},{immediate:!1,deep:!0}),B(()=>t.initialized,i=>{i&&_()}),e.isServerSync&&(B(()=>e.page,()=>{t.pagination={...t.pagination,page:e.page}}),B(()=>e.itemsPerPage,()=>{t.pagination={...t.pagination,itemsPerPage:e.itemsPerPage}}),B(()=>e.totalItemsCount,()=>{t.pagination={...t.pagination,totalCount:e.totalItemsCount}})),B(()=>e.isLoading,i=>{setTimeout(()=>{t.showLoading=i},100)},{immediate:!0});function v(i){e.isServerSync||(t.pagination.itemsPerPage=Number(i),t.pagination.page=1),o("update:items-per-page",Number(i))}function A(){if(l.value>=u.value||e.isLoading)return;const i=Number(t.pagination.page)+1;o("update:page-index",i),e.isServerSync||(t.pagination={...t.pagination,page:i})}function E(){if(l.value<=1||e.isLoading)return;const i=Number(t.pagination.page)-1;o("update:page-index",i),e.isServerSync||(t.pagination={...t.pagination,page:i})}function x(){e.isServerSync||(t.items=H({items:e.items,sortBy:t.sortBy,headers:e.headers}),t.pagination.page=1)}function M(i){e.rowClickable&&o("row-click",i)}function U(i){if(!i.sortable)return;const y=t.sortBy.findIndex(j=>j.key===i.key);if(y===-1){t.sortBy=[{...i,sortOrder:"asc"}],o("update:sort-by",t.sortBy),x();return}t.sortBy[y].sortOrder==="asc"?t.sortBy.splice(y,1,{...i,sortOrder:"desc"}):t.sortBy.splice(y,1),o("update:sort-by",t.sortBy),x()}function V(){o("update:retry")}return{state:t,hasHeaderSlot:g,hasDefaultSlot:p,hasFooterSlot:m,paginationOffset:a,totalPages:u,currentItems:d,onSelectChange:v,onNextPageTriggerClick:A,onPrevPageTriggerClick:E,onSortByChange:x,onHeaderItemClick:U,onRowClick:M,onRetry:V}}}),He={class:"c-datatable"},Ae={class:"table-wrapper"},Ee={key:2},Me=["onClick"];function Ue(e,o,n,g,p,m){const t=D("CDatatableHeader"),d=D("CDatatableLoadingBar"),l=D("CDatatableRowItem"),a=D("CDatatableSkeletonRow"),u=D("CDatatableEmptyData"),b=D("CDatatableFooter");return r(),c("div",He,[s("div",Ae,[s("table",null,[e.hasHeaderSlot?q(e.$slots,"header",{key:0}):(r(),w(t,{key:1,headers:e.headers,"sort-by":e.state.sortBy,"onUpdate:sortBy":e.onHeaderItemClick},null,8,["headers","sort-by","onUpdate:sortBy"])),k(d,{"is-loading":e.state.showLoading},null,8,["is-loading"]),e.state.items&&e.state.items.length>0?(r(),c("tbody",Ee,[e.hasDefaultSlot?(r(!0),c(S,{key:0},R(e.currentItems,(_,v)=>(r(),c("tr",{key:`item-i${v}`,class:L(["datatable-item",{"cursor-pointer":e.rowClickable}]),onClick:N(()=>e.onRowClick(_),["prevent","stop"])},[q(e.$slots,"default",{item:_,index:v})],10,Me))),128)):(r(!0),c(S,{key:1},R(e.currentItems,(_,v)=>(r(),w(l,{key:`item-i${v}`,item:_,index:v,clickable:e.rowClickable,headers:e.headers,"onRow:click":()=>e.onRowClick(_)},null,8,["item","index","clickable","headers","onRow:click"]))),128))])):e.state.showLoading&&!e.noSkeleton?(r(),w(a,{key:3})):h("",!0),!e.state.showLoading&&(!e.state.items||e.state.items.length===0)?(r(),w(u,{key:4,visible:!e.state.showLoading&&(!e.state.items||e.state.items.length===0),onRetry:e.onRetry},null,8,["visible","onRetry"])):h("",!0)])]),e.noFooter?h("",!0):(r(),c(S,{key:0},[e.hasFooterSlot?q(e.$slots,"footer",{key:0}):(r(),w(b,{key:1,pages:e.pages,"items-per-page":e.itemsPerPage,pagination:e.state.pagination,"allow-total":e.allowTotal,"onClick:nextPage":e.onNextPageTriggerClick,"onClick:prevPage":e.onPrevPageTriggerClick,"onUpdate:itemsPerPage":e.onSelectChange},null,8,["pages","items-per-page","pagination","allow-total","onClick:nextPage","onClick:prevPage","onUpdate:itemsPerPage"]))],64))])}const Ye=Q(Fe,[["render",Ue]]);export{Ye as C};
